function showtime(r) { for (document.myform.zhyz1.disabled = !0, i = 1; i <= r; i++)window.setTimeout("update_p(" + i + "," + r + ")", 1e3 * i) } function update_p(r, o) { r == o ? (document.myform.zhyz1.value = " 重新发送 ", document.myform.zhyz1.disabled = !1) : (printnr = o - r, document.myform.zhyz1.value = " (" + printnr + ")重新发送") } function huoquyzm() { for (var r = $(".zhao").val(), o = "", t = 0; t < 6; t++)o += randomNum(0, 9); var e = "zhao=" + r + "&yzm=" + o; document.cookie = "huoquyzm=" + o, $.ajax({ type: "post", url: "../api/SendMail.php", data: e, success: function (r) { console.log(r) } }), showtime(60) } function suijiyzms() { $(".yzm p ").html(""); for (var r = 0; r < 6; r++)suijiyzm = randomNum(0, 9), color1 = getRandomColor(), color2 = getRandomColor(), color3 = getRandomColor(), color4 = getRandomColor(), color5 = getRandomColor(), color6 = getRandomColor(), deg1 = randomNum(-80, 80), deg2 = randomNum(-80, 80), deg3 = randomNum(-80, 80), deg4 = randomNum(-80, 80), deg5 = randomNum(-80, 80), deg6 = randomNum(-80, 80), $(".yzm p ").append("<span>" + suijiyzm + "</span>"), $(".yzm p span:nth-child(1)").css({ color: color1, transform: "rotate(" + deg1 + "deg)" }), $(".yzm p span:nth-child(2)").css({ color: color2, transform: "rotate(" + deg2 + "deg)" }), $(".yzm p span:nth-child(3)").css({ color: color3, transform: "rotate(" + deg3 + "deg)" }), $(".yzm p span:nth-child(4)").css({ color: color4, transform: "rotate(" + deg4 + "deg)" }), $(".yzm p span:nth-child(5)").css({ color: color5, transform: "rotate(" + deg5 + "deg)" }), $(".yzm p span:nth-child(6)").css({ color: color6, transform: "rotate(" + deg6 + "deg)" }) } $(".register-footer").load("public/footer.html"), suijiyzms(), $(".next").click(function () { var r = getRandomColor(); $(this).prev().css("background", r), suijiyzms() }); var OK1 = !1, OK2 = !1, OK3 = !1, OK4 = !1, OK5 = !1; function pwd2() { $(".register-register form .mima1").on("keyup", function () { var r = { reg: /^[a-zA-Z]\w{5,17}$/, str: $(this).val().trim(), nullmsg: "●密码不能为空，请输您要设置的密码", errormsg: "●密码(以字母开头，长度在6~18之间)", success: "1" }, o = recheck(r), t = $(this); if ("1" == o) { var e = $("form .mima").val().trim(), s = $("form .mima1").val().trim(); OK4 = s == e ? (t.next().html("●验证通过"), t.next().css("color", "#58bc58"), !0) : (t.next().html("●两次密码不一致"), t.next().css("color", "red"), !1), OKbtn() } else errormsgs(t, o), OK4 = !1; OKbtn() }) } function errormsgs(r, o) { r.next().html(o), r.next().css("color", "red") } function OKbtn() { OK1 && OK2 && OK3 && OK4 && 1 == OK5 ? ($(".zhucebtn").css("background", "#ff0036"), $(".zhucebtn").css({ background: "#ff0036", cursor: "pointer" }), $(".zhucebtn").click(function () { $.ajax({ type: "POST", url: "../api/phpapi/index.php", data: { name: $(".zhao").val().trim(), pwd: $(".mima").val(), type: "register" }, success: function (r) { r ? (alert("注册成功，请登录"), window.location.href = "login.html") : alert("注册失败，请稍后再试") } }) })) : ($(".zhucebtn").css("background", "#ccc"), $(".zhucebtn").css({ background: "#ccc", cursor: "not-allowed" })) } $(".register-register form .zhao").on("keyup", function () { var r = { reg: /^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$|^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$/, str: $(this).val().trim(), nullmsg: "●账号不能为空，请输您的账号", errormsg: "●账号格式不对，账号为邮箱 或 手机号码", success: "1" }, o = recheck(r), t = $(this); if ("1" == o) { var e = "name=" + $(this).val().trim() + "&pwd=" + $(".mima").val() + "&type=select"; $.ajax({ type: "POST", url: "../api/phpapi/index.php", data: e, success: function (r) { $data = JSON.parse(r), $data ? (t.next().html("●此账号已存在"), t.next().css("color", "red"), t.next().margin = "5px", OK1 = !1) : (OK1 = !0, t.next().html("●此账号可以使用"), t.next().css("color", "#58bc58"), t.next().margin = "5px", $(".zhyz .huoquyzm").css({ background: "red", cursor: "pointer" }), OKbtn(), $(".huoquyzm").on("click", function () { huoquyzm() })) } }) } else errormsgs(t, o), OK1 = !1, $(".zhyz .huoquyzm").css({ background: "#ccc", cursor: "not-allowed" }); OKbtn() }), $(".register-register form .zhyz1").on("keyup", function () { var r = { reg: /[0-9]{6}/, str: $(this).val().trim(), nullmsg: "●验证码不能为空，请输您收到的验证码", errormsg: "●验证码格式不对，验证码为6位数字", success: "1" }, o = recheck(r), t = $(this).parent(), e = cookie.get("huoquyzm"); (console.log(e), "1" == o) ? $(".zhyz1").val().trim() == e ? (t.next().html("●验证通过"), t.next().css("color", "#58bc58"), OK2 = !0) : (t.next().html("●验证码错误"), t.next().css("color", "red")) : (errormsgs(t, o), OK2 = !1); OKbtn() }), $(".register-register form .mima").on("keyup", function () { var r = { reg: /^[a-zA-Z]\w{5,17}$/, str: $(this).val().trim(), nullmsg: "●密码不能为空，请输您要设置的密码", errormsg: "●密码(以字母开头，长度在6~18之间)", success: "1" }, o = recheck(r), t = $(this); OK3 = "1" == o ? (t.next().html("●验证通过"), t.next().css("color", "#58bc58"), !0) : (errormsgs(t, o), !1), OKbtn(), OKbtn() }), pwd2(), $(".register-register form .yzminput").on("keyup", function () { var r = { reg: /[0-9]{6}/, str: $(this).val().trim(), nullmsg: "●验证码不能为空，请输您收到的验证码", errormsg: "●验证码格式不对，验证码为6位数字", success: "1" }, o = recheck(r), t = $(this).next(), e = $(".yzm p span").text(); "1" == o ? $(this).val().trim() == e ? (t.next().html("●验证通过"), t.next().css("color", "#58bc58"), OK5 = !0) : (t.next().html("●验证码错误"), t.next().css("color", "red")) : (errormsgs(t, o), OK5 = !1); OKbtn() });