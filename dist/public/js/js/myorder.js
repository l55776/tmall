"use strict";$(".header").load("public/header.html"),$(".footer").load("public/footer.html"),$(window).scroll(function(){$(".cartMain").height();var e=$(window).scrollTop();300<=e&&$(".bar-wrapper ").css("position"," relative"),e<=300&&$(".bar-wrapper").css("position","fixed")});var cookie=cookie.get("uid"),state=decodeURIs();function dianj(){var i,e=!0;function t(){for(var e=0,s=$(".order_lists .son_check").next(),a=[],i=0;i<s.length;i++)s.eq(i).attr("checked")&&a.push(i),a.length==s.length?$(".cartBox .shop").css("background-image","url(../public/img/order/mark1.png)"):$(".cartBox .shop").css("background-image","none");var t=0;for(i=0;i<a.length;i++)t+=1*s.eq(a[i]).parent().siblings(".list_sum").find(".sum_price").html().substring(1),e+=1*s.eq(a[i]).parent().siblings(".list_amount").find(".sum").val();$(".total_text").html("￥"+t.toFixed(2)),$(".piece_num").html(e)}function a(e,s){$.ajax({type:"POST",url:"../api/phpapi/index.php",data:{type:"db_update",name:"order_number",why:e,num:s}})}function n(e,s){var a=$(e).parent().parent().prev().find(".price").html().substring(1);i=s*a,$(e).parent().parent().next().find(".sum_price").html("￥"+i)}$(".cartBox .shop").click(function(){e?($(".order_lists .son_check").next("label").css("background-image","url(../public/img/order/mark1.png)"),$(".order_lists .son_check").next("label").attr("checked","checked")):($(".order_lists .son_check").next("label").css("background-image","none"),$(".order_lists .son_check").next("label").removeAttr("checked")),e=!e,t()}),$("input[type='checkbox']").css("display","none"),$("input[type='checkbox']").click(function(){$(this).next("label").attr("checked")?($(this).next("label").css("background-image","none"),$(this).next("label").removeAttr("checked"),$(".bar-wrapper .bar-right .calBtn a").css("background","#B0B0B0"),$(".bar-wrapper .bar-right .calBtn a").css("cursor","not-allowed")):($(this).next("label").css("background-image","url(../public/img/order/mark1.png)"),$(this).next("label").attr("checked","checked"),$(".bar-wrapper .bar-right .calBtn a").css("background","red"),$(".bar-wrapper .bar-right .calBtn a").css("cursor","pointer")),t()}),$(".amount_box").on("click","a:eq(1)",function(){var e=$(this).prev().val();console.log(e),e++,$(this).prev().val(e);var s=parseInt($(this).parent().attr("id"));n(this,e),t(),a(s,e)}),$(".amount_box").on("click","a:eq(0)",function(){var e=$(this).next().val();e=--e<=1?1:e;var s=parseInt($(this).parent().attr("id"));$(this).next().val(e),n(this,e),t(),console.log(e),a(s,e)}),$(".list_op").on("click",".delBtn",function(){$(".model_bg").css("display","block"),$(".my_model").css("display","block");var s=$(this).parent().parent().parent(),a=$(this);$(".dialog-sure").on("click",function(){s.remove();var e=parseInt(a.parent().attr("id"));$.ajax({type:"POST",url:"../api/phpapi/index.php",data:{type:"db_delete",why:e},success:function(e){}}),$(".order_content .order_lists").length||$(".cartBox .shop").css("background-image","none"),$(".model_bg").css("display","none"),$(".my_model").css("display","none"),t()})}),$(".closeModel").click(function(){$(".model_bg").css("display","none"),$(".my_model").css("display","none")})}"bay"==state.state&&$.ajax({type:"post",url:"../api/phpapi/index.php",data:{uid:cookie,type:"orderxiangqing",good_id:state.good_id},success:function(e){var s=JSON.parse(e)[0];console.log(s);var a=' <ul class="order_lists">\n                <li class="list_chk">\n                    <input type="checkbox" id="checkbox_'+s.order_id+'" class="son_check">\n                    <label for="checkbox_'+s.order_id+'"></label>\n                </li>\n                <li class="list_con">\n                    <div class="list_img"><a href="javascript:;"><img src="'+s.order_images+'"\n                                alt=""></a></div>\n                    <div class="list_text"><a href="javascript:;">'+s.order_title+'</a></div>\n                    <div class="item-icons">\n                        <a href=""><img src="https://assets.alicdn.com/sys/common/icon/trade/xcard.png" alt=""></a>\n                        <a href=""><img src="https://img.alicdn.com/tps/i3/T1Vyl6FCBlXXaSQP_X-16-16.png" alt=""></a>\n                        <a href=""><img src="https://img.alicdn.com/tps/i4/T1BCidFrNlXXaSQP_X-16-16.png" alt=""></a>\n                    </div>\n                </li>\n                <li class="list_info">\n                    <p>规格：默认</p>\n                    <p>尺寸：16*16*3(cm)</p>\n                </li>\n                <li class="list_price">\n                    <p class="price">￥'+s.order_price+'</p>\n                </li>\n                <li class="list_amount">\n                    <div class="amount_box" id="'+s.order_id+'">\n                        <a href="javascript:;" class="reduce reSty">-</a>\n                        <input type="text" value="'+s.order_number+'" class="sum">\n                        <a href="javascript:;" class="plus">+</a>\n                    </div>\n                </li>\n                <li class="list_sum">\n                    <p class="sum_price">￥'+s.order_price*s.order_number+'</p>\n                </li>\n                <li class="list_op">\n                    <p class="del" id="'+s.order_id+'"  ><a href="javascript:;" class="delBtn" id="'+s.order_id+'" >移除商品</a></p>\n                </li>\n            </ul>';$(".order_content").html(a),dianj()}}),"gwc"==state.state&&$.ajax({type:"post",url:"../api/phpapi/index.php",data:{uid:cookie,type:"gouwuche"},success:function(e){var s=JSON.parse(e),a="";a+=$.map(s.orderselsect,function(e,s){return' <ul class="order_lists">\n                <li class="list_chk">\n                    <input type="checkbox" id="checkbox_'+e.order_id+'" class="son_check">\n                    <label for="checkbox_'+e.order_id+'"></label>\n                </li>\n                <li class="list_con">\n                    <div class="list_img"><a href="javascript:;"><img src="'+e.order_images+'"\n                                alt=""></a></div>\n                    <div class="list_text"><a href="javascript:;">'+e.order_title+'</a></div>\n                    <div class="item-icons">\n                        <a href=""><img src="https://assets.alicdn.com/sys/common/icon/trade/xcard.png" alt=""></a>\n                        <a href=""><img src="https://img.alicdn.com/tps/i3/T1Vyl6FCBlXXaSQP_X-16-16.png" alt=""></a>\n                        <a href=""><img src="https://img.alicdn.com/tps/i4/T1BCidFrNlXXaSQP_X-16-16.png" alt=""></a>\n                    </div>\n                </li>\n                <li class="list_info">\n                    <p>规格：默认</p>\n                    <p>尺寸：16*16*3(cm)</p>\n                </li>\n                <li class="list_price">\n                    <p class="price">￥'+e.order_price+'</p>\n                </li>\n                <li class="list_amount" >\n                    <div class="amount_box" id="'+e.order_id+'">\n                        <a href="javascript:;" class="reduce reSty">-</a>\n                        <input type="text" value="'+e.order_number+'" class="sum">\n                        <a href="javascript:;" class="plus">+</a>\n                    </div>\n                </li>\n                <li class="list_sum">\n                    <p class="sum_price">￥'+e.order_price*e.order_number+'</p>\n                </li>\n                <li class="list_op" >\n                    <p class="del" id="'+e.order_id+'"><a href="javascript:;" class="delBtn"  id="'+e.order_id+'">移除商品</a></p>\n                </li>\n            </ul>'}).join(""),$(".order_content").html(a),dianj()}});